# 基础知识

## 1. **位图 && 矢量图**

**位图**：位图是由称作像素的单个点组成的。这些点通过不同的排列、染色构成图像。最常见的格式是：JPEG、PNG、GIF、BMP 和 TIFF

**矢量图**：使用直线和曲线来描述图形，包括圆形、长方形、线条和曲线等形状；它们都是通过数学公式计算获得的。它的特点是放大后图像不会失真，和分辨率无关，适用于图形设计、文字设计和一些标志设计、版式设计等。

对位图进行放大：
<img src="./assets/image.png">

“canvas” 元素用于生成图像。它本身就像一个画布，JavaScript 通过操作它的 API，在上面生成图像。它的底层是一个个像素，基本上 “canvas” 是一个可以用 JavaScript 操作的位图（bitmap）

## 2. 选择哪种渲染器？

一般来说，Canvas 更适合绘制图形元素数量较多（这一般是由数据量大导致）的图表（如热力图、地理坐标系或平行坐标系上的大规模线图或散点图等），也利于实现某些视觉 特效。但是，在不少场景中，SVG 具有重要的优势：它的内存占用更低（这对移动端尤其重要）、并且用户使用浏览器内置的缩放功能时不会模糊。

选择哪种渲染器，我们可以根据软硬件环境、数据量、功能需求综合考虑。

- 在软硬件环境较好，数据量不大的场景下，两种渲染器都可以适用，并不需要太多纠结。
- 在环境较差，出现性能问题需要优化的场景下，可以通过试验来确定使用哪种渲染器。比如有这些经验：
  - 在需要创建很多 ECharts 实例且浏览器易崩溃的情况下（可能是因为 Canvas 数量多导致内存占用超出手机承受能力），可以使用 SVG 渲染器来进行改善。大略的说，如果图表运行在低端安卓机，或者我们在使用一些特定图表如 水球图 等，SVG 渲染器可能效果更好。
  - 数据量较大（经验判断 > 1k）、较多交互时，建议选择 Canvas 渲染器。

## 3. canvas 模糊？

### 一 ppi,dpr,dip,分辨率,屏幕尺寸,设备物理像素，设备独立像素

**分辨率**：1920px\*1080px 在这个设备上纵向上有 1920 个像素点（色块）... 在通常情况下，分辨率 1920px×1080px 中的像素指的是逻辑像素

**屏幕尺寸**：5 英寸(in) = 5\*2.54(cm) 指的是在这个屏幕上对角线的长度使用英寸单位 这个值是每个设备固定不变的

**设备独立像素(逻辑像素) dip**: 指的是 css 的像素 ideal viewport (dip)设备独立像素 === css 像素 === 逻辑像素

**物理像素（Physical Pixel）**：是设备屏幕实际拥有的像素点，这些像素点是硬件层面的概念，由屏幕的制造工艺决定。例如，在液晶显示器（LCD）中，物理像素是液晶显示单元的最小单位，它们通过不同的排列组合来显示图像内容。

**设备像素比 dpr**: 指的是一个设备上的 物理像素和独立像素的比值 dpr = 设备像素/设备独立像素(css 像素)
dpr = 设备像素/CSS 像素 = 设备像素 / 设备独立像素 ~= PPI/160 = 页面缩放比例
根据 dpr 可以判断 一个 css 像素代表多少个设备像素点 1:1, 2:1 一个 css 像素代表 4 个物理像素
3:1 一个 css 像素代表 9 个物理像素

例如，在某些视网膜（Retina）显示屏上，设备像素比可能是 2（在一些更高端的设备上可能是 3 甚至更高）。这意味着，对于一个分辨率为 1920px×1080px 的逻辑分辨率（CSS 像素）的内容，在该设备上实际占用的物理像素可能是 3840px×2160px（假设 DPR = 2）。在这种情况下，当我们说 1920px×1080px 分辨率时，这个 1920px（纵向）指的是逻辑像素，而不是物理像素。

**像素密度 ppi**: ppi 和 dpi 指的是一个设备上每英寸长度上有多少个像素点 ppi = 对角线上的像素数量/尺寸

### 二. css 单位：px,em,rem,vw,vh:

- px: 相对单位 根据 dpr 相对设备物理像素的 数量
- em: 相对单位 根据父元素的字体大小，相对父元素的字体大小成倍
- rem: 相对单位 根据根目录 html 的字体大小，相对 html 元素字体大小成倍
- vw,vh: 相对单位 根据每个设备的屏幕大小，宽和高，相对屏幕分成 100 份 100vw,100vh 为满屏

### 三. viewport 虚拟视窗

1.layout viewport 视窗为 980px

- document.documentElement.clientWidth 和-Height 可以获取 layout viewport 的尺寸

  2.visual viewport

- 可视的视窗
- 默认虚拟相对于 ideal viewport 缩放
- window.innerWidth/Height 来获取 visual viewport 的尺寸

  3.ideal viewport

- ideal viewport 的宽度等于移动设备的屏幕宽度(即设备逻辑像素)，跟设备的物理宽度没有关系
- ideal viewport 的宽度 = 屏幕的逻辑像素宽度

  4.缩放因子：

- 相对于 ideal viewport 来缩放的
- 缩放改变的是 每 CSS 像素单位代表的物理像素长度，而设备像素保持不变
- zoom factor = ideal viewport width / visual viewport width

### canvas 糊掉？

```
<canvas id="canvas" width="200" height="200"></canvas>
```

canvas 不管 DPR 是 1 是 2 还是 3，他就是会将整个 canvas 绘图区域塞进 css 宽高并填满, 解决办法：

```
// devicePixelRatio = 2
<style>
canvas {
    width: 200px;
    height: 200px;
}
</style>
<canvas id="canvas" width="400" height="400"></canvas>
```

可以参考：
https://developer.mozilla.org/zh-CN/docs/Web/API/Window/devicePixelRatio
